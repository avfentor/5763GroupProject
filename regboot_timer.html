<!DOCTYPE HTML><html><head><meta charset="UTF-8"></meta><link rel="stylesheet" href="./log.css"></link><script type="text/javascript" src="http://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js" charset="UTF-8"></script><style rel="stylesheet">.sasError {color: red;}.sasMessage{color:#000000;}.sasWarning{color:green;}.sasSource{color:#000000;}.sasNote {color:blue;}</style><title>Log:regBoot_timer.sas</title></head><body class='sasLog'><pre class='sasLog' id='pre_sasLog_21' style='background-color:transparent; -webkit-user-select: text; -webkit-user-modify: read-only;-webkit-touch-callout: default;border-top-width: 0px;border-bottom-width: 0px'><div class="sasSource"> </div><div class="sasSource"> 1          OPTIONS NONOTES NOSTIMER NOSOURCE NOSYNTAXCHECK;</div><div class="sasSource"> 72         </div><div class="sasSource"> 73         /*A~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/</div><div class="sasSource"> 74         /*This is a small SAS program to perform nonparametric bootstraps for a regression</div><div class="sasSource"> 75         /*It is not efficient nor general*/</div><div class="sasSource"> 76         /*Inputs: */</div><div class="sasSource"> 77         /*- NumberOfLoops: the number of bootstrap iterations</div><div class="sasSource"> 78         /*- Dataset: A SAS dataset containing the response and covariate*/</div><div class="sasSource"> 79         /*- XVariable: The covariate for our regression model (gen. continuous numeric)*/</div><div class="sasSource"> 80         /*- YVariable: The response variable for our regression model (gen. continuous numeric)*/</div><div class="sasSource"> 81         /*Outputs:*/</div><div class="sasSource"> 82         /*- ResultHolder: A SAS dataset with NumberOfLoops rows and two columns, RandomIntercept &amp; RandomSlope*/</div><div class="sasSource"> 83         /*~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~*/</div><div class="sasSource"> 84         </div><div class="sasSource"> 85         %macro regBoot(NumberOfLoops, DataSet, XVariable, YVariable);</div><div class="sasSource"> 86         </div><div class="sasSource"> 87         </div><div class="sasSource"> 88         /*Number of rows in my dataset*/</div><div class="sasSource"> 89          data _null_;</div><div class="sasSource"> 90           set &amp;DataSet NOBS=size;</div><div class="sasSource"> 91           call symput("NROW",size);</div><div class="sasSource"> 92          stop;</div><div class="sasSource"> 93          run;</div><div class="sasSource"> 94         </div><div class="sasSource"> 95         /*loop over the number of randomisations required*/</div><div class="sasSource"> 96         %do i=1 %to &amp;NumberOfLoops;</div><div class="sasSource"> 97         </div><div class="sasSource"> 98         </div><div class="sasSource"> 99         /*Sample my data with replacement*/</div><div class="sasSource"> 100        proc surveyselect data=&amp;DataSet out=bootData seed=-23434 method=urs noprint sampsize=&amp;NROW;</div><div class="sasSource"> 101        run;</div><div class="sasSource"> 102        </div><div class="sasSource"> 103        /*Conduct a regression on this randomised dataset and get parameter estimates*/</div><div class="sasSource"> 104        proc reg data=bootData outest=ParameterEstimates  noprint;</div><div class="sasSource"> 105        Model &amp;YVariable=&amp;XVariable;</div><div class="sasSource"> 106        run;</div><div class="sasSource"> 107        quit;</div><div class="sasSource"> 108        </div><div class="sasSource"> 109        /*Extract just the columns for slope and intercept for storage*/</div><div class="sasSource"> 110        data Temp;</div><div class="sasSource"> 111        set ParameterEstimates;</div><div class="sasSource"> 112        keep Intercept &amp;XVariable;</div><div class="sasSource"> 113        run;</div><div class="sasSource"> 114        </div><div class="sasSource"> 115        /*Create a new results dataset if the first iteration, append for following iterations*/</div><div class="sasSource"> 116        data ResultHolder;</div><div class="sasSource"> 117        %if &amp;i=1 %then %do;</div><div class="sasSource"> 118        set Temp;</div><div class="sasSource"> 119        %end;</div><div class="sasSource"> 120        %else %do;</div><div class="sasSource"> 121        set ResultHolder Temp;</div><div class="sasSource"> 122        %end;</div><div class="sasSource"> 123        run;</div><div class="sasSource"> 124        %end;</div><div class="sasSource"> 125        /*Rename the results something nice*/</div><div class="sasSource"> 126        data ResultHolder;</div><div class="sasSource"> 127        set ResultHolder;</div><div class="sasSource"> 128        rename Intercept=RandomIntercept &amp;XVariable=RandomSlope;</div><div class="sasSource"> 129        run;</div><div class="sasSource"> 130        %mend;</div><div class="sasSource"> 131        </div><div class="sasSource"> 132        options nonotes;</div><div class="sasSource"> 133        /*Run the macro with timer*/</div><div class="sasSource"> 134        %let _timer_start = %sysfunc(datetime());</div><div class="sasSource"> 135        %regBoot(NumberOfLoops=100, DataSet=work.fitness, XVariable=age, YVariable=oxygen);</div><div class="sasSource"> 136        data _null_;</div><div class="sasSource"> 137          dur = datetime() - &amp;_timer_start;</div><div class="sasSource"> 138          put 30*'-' / ' TOTAL DURATION:' dur time13.2 / 30*'-';</div><div class="sasSource"> 139        run;</div><div class="sasSource"> ------------------------------</div><div class="sasSource">  TOTAL DURATION:   0:00:03.12</div><div class="sasSource"> ------------------------------</div><div class="sasSource"> 140        </div><div class="sasSource"> 141        </div><div class="sasSource"> 142        </div><div class="sasSource"> 143        </div><div class="sasSource"> 144        OPTIONS NONOTES NOSTIMER NOSOURCE NOSYNTAXCHECK;</div><div class="sasSource"> 156        </div></pre></body></html>